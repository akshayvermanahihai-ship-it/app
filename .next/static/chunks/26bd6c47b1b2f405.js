(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,71689,e=>{"use strict";e.s(["ArrowLeft",()=>t],71689);let t=(0,e.i(75254).default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},55146,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),a=e.i(71645),s=e.i(71689),r=e.i(8776),n=e.i(18566);function l(e){let{params:l}=e,o=(0,r.useToastContext)(),i=(0,n.useRouter)(),[c,d]=(0,a.useState)(null),[m,x]=(0,a.useState)(!0),[u,g]=(0,a.useState)(""),[b,p]=(0,a.useState)(""),[h,y]=(0,a.useState)(new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta"})),[f,j]=(0,a.useState)(""),[N,v]=(0,a.useState)({examination_id:"",number_scan:"",number_film:"",number_contrast:"",technician_name:"",nursing_name:"",issue_cd:"NO",remark:"",console_date:new Date().toLocaleDateString("en-CA"),console_time:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1})});(0,a.useEffect)(()=>{l.then(e=>j(decodeURIComponent(e.cro)))},[l]),(0,a.useEffect)(()=>{f&&w();let e=setInterval(()=>{y(new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta"}))},1e3);return()=>clearInterval(e)},[f]);let w=async()=>{x(!0);try{let e=await fetch("/api/console/patient/".concat(encodeURIComponent(f)));if(e.ok){let t=await e.json();if(d(t.data),t.data.console){let e=t.data.console;v({examination_id:e.examination_id||"",number_scan:e.number_scan||"",number_film:e.number_films||"",number_contrast:e.number_contrast||"",technician_name:e.technician_name||"",nursing_name:e.nursing_name||"",issue_cd:e.issue_cd||"NO",remark:e.remark||"",console_date:new Date().toLocaleDateString("en-CA"),console_time:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1})}),g(e.start_time||""),p(e.stop_time||"")}}else{let t=await e.json().catch(()=>({}));console.error("Console patient API error:",t),o.error("API Error: ".concat(t.error||"Failed to fetch patient data",". Details: ").concat(t.details||"Unknown error"))}}catch(e){console.error("Error fetching patient data:",e),o.error("Error loading patient data")}finally{x(!1)}},k=async(e,t)=>{try{(await fetch("/api/console/update-scan-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scan_id:e,patient_id:f,status:t})})).ok?(w(),o.success("Scan status updated")):o.error("Failed to update scan status")}catch(e){console.error("Error updating scan status:",e),o.error("Error updating scan status")}},_=async e=>{try{if(!N.examination_id)return void o.error("Please enter Examination ID");let t=e;"Complete"===e&&(t="Complete");let a=await fetch("https://varahasdc.co.in/api/console/save-console",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cro:f,start_time:u,stop_time:b,status:t,...N})});if(a.ok)await a.json(),"Complete"===e?(o.success("Console completed successfully!"),i.push("/console")):"Pending"===e&&(o.success("Console marked as pending"),i.push("/console"));else{let e=await a.json().catch(()=>({}));o.error("Failed to save console data: ".concat(e.error||"Unknown error"))}}catch(e){console.error("Error saving console data:",e),o.error("Error saving console data")}};if(m)return(0,t.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading patient data..."})]})});if(!c)return(0,t.jsxs)("div",{className:"p-6 text-center",children:[(0,t.jsx)("p",{className:"text-red-600",children:"Patient not found"}),(0,t.jsx)("button",{onClick:()=>i.push("/console"),className:"mt-4 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700",children:"Back to Queue"})]});let C=c.scans.every(e=>"complete"===e.status);return c.scans.filter(e=>"pending"===e.status).length,(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white p-6 rounded-xl shadow-lg",children:(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("button",{onClick:()=>i.push("/console"),className:"p-2 bg-sky-500 hover:bg-sky-400 rounded-lg transition-colors",children:(0,t.jsx)(s.ArrowLeft,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Console - ",f]}),(0,t.jsx)("p",{className:"text-sky-100",children:"Patient examination console"})]})]})})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Patient History"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Console Date Of Examination"}),(0,t.jsx)("input",{type:"text",value:new Date().toLocaleDateString("en-GB").replace(/\//g,"-"),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Console Time"}),(0,t.jsx)("input",{type:"text",value:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1}),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CRO Number"}),(0,t.jsx)("input",{type:"text",value:c.patient.cro,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Name"}),(0,t.jsx)("input",{type:"text",value:"".concat(c.patient.pre," ").concat(c.patient.patient_name),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age"}),(0,t.jsx)("input",{type:"text",value:c.patient.age,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctor"}),(0,t.jsx)("input",{type:"text",value:c.patient.doctor_name,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,t.jsx)("input",{type:"text",value:c.patient.category,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact"}),(0,t.jsx)("input",{type:"text",value:c.patient.contact_number,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Timer"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time"}),(0,t.jsx)("button",{onClick:()=>{g(h)},className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-lg font-mono",children:u||h})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stop Time"}),(0,t.jsx)("button",{onClick:()=>{p(h)},className:"w-full px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-lg font-mono",children:b||h})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"MRI Details"}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"S.No"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"MRI NAME"}),(0,t.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Action"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200",children:c.scans.map((e,a)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{className:"px-4 py-4 text-sm text-black font-medium",children:a+1}),(0,t.jsx)("td",{className:"px-4 py-4 text-sm font-medium text-black",children:e.s_name}),(0,t.jsx)("td",{className:"px-4 py-4",children:(0,t.jsxs)("div",{className:"flex space-x-4",children:[(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"radio",name:"scan_".concat(e.s_id||e.scan_id||a),checked:"pending"===e.status,onChange:()=>k(e.scan_id,"pending"),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Pending"})]}),(0,t.jsxs)("label",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"radio",name:"scan_".concat(e.s_id||e.scan_id||a),checked:"complete"===e.status,onChange:()=>k(e.scan_id,"complete"),className:"mr-2"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Complete"})]})]})})]},e.s_id||e.scan_id||a))})]})})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Console Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Examination ID ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)("input",{type:"number",value:N.examination_id,onChange:e=>v({...N,examination_id:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Scans"}),(0,t.jsx)("input",{type:"number",value:N.number_scan,onChange:e=>v({...N,number_scan:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Films"}),(0,t.jsx)("input",{type:"number",value:N.number_film,onChange:e=>v({...N,number_film:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Contrast"}),(0,t.jsx)("input",{type:"number",value:N.number_contrast,onChange:e=>v({...N,number_contrast:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Technician Name"}),(0,t.jsx)("input",{type:"text",value:N.technician_name,onChange:e=>v({...N,technician_name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nursing Name"}),(0,t.jsx)("input",{type:"text",value:N.nursing_name,onChange:e=>v({...N,nursing_name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue CD/DVD"}),(0,t.jsxs)("select",{value:N.issue_cd,onChange:e=>v({...N,issue_cd:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",children:[(0,t.jsx)("option",{value:"NO",children:"NO"}),(0,t.jsx)("option",{value:"YES",children:"YES"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remark"}),(0,t.jsx)("textarea",{value:N.remark,onChange:e=>v({...N,remark:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]})]})]}),(0,t.jsxs)("div",{className:"flex justify-center space-x-4",children:[C?(0,t.jsx)("button",{onClick:()=>_("Complete"),className:"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium shadow-lg",children:"Complete"}):(0,t.jsx)("button",{onClick:()=>_("Pending"),className:"px-8 py-3 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium shadow-lg",children:"Pending"}),(0,t.jsx)("button",{onClick:()=>{window.confirm("You Click On Recall Button, Patient Data Is Not Save And Patient Is Sent On Reception Table")&&(o.info("Patient recalled to reception"),i.push("/console"))},className:"px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg",children:"Recall"})]})]})}}]);