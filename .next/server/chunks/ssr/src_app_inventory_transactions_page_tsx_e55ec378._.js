module.exports=[1368,a=>{"use strict";a.s(["default",()=>j]);var b=a.i(87924),c=a.i(72131),d=a.i(84505),e=a.i(81464),f=a.i(24669),g=a.i(53277),h=a.i(82651),i=a.i(66632);function j(){let a=(0,i.useToastContext)(),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)([]),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)("INWARD"),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)({type:"ALL",from_date:"",to_date:"",item_id:""}),[x,y]=(0,c.useState)({item_id:"",quantity:"",rate:"",supplier:"",invoice_no:"",department:"",issued_to:"",purpose:"",remarks:""});(0,c.useEffect)(()=>{B(),z()},[]);let z=async()=>{try{let a=await fetch("https://varahasdc.co.in/api/inventory/items");if(a.ok){let b=await a.json();b.success&&m(b.data||[])}}catch(a){console.error("Error fetching items:",a)}},A=async b=>{if(b.preventDefault(),!x.item_id||!x.quantity)return void a.error("Please fill in required fields");u(!0);try{let b="INWARD"===r?"/inward":"/outward",c=await fetch(`https://varahasdc.co.in/api/inventory${b}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...x,quantity:parseInt(x.quantity),rate:parseFloat(x.rate)||0})}),d=await c.json();c.ok&&d.success?(a.success(`${r} transaction recorded successfully`),q(!1),y({item_id:"",quantity:"",rate:"",supplier:"",invoice_no:"",department:"",issued_to:"",purpose:"",remarks:""}),B(),z()):a.error(d.error||"Failed to record transaction")}catch(b){console.error("Error submitting transaction:",b),a.error("Network error while submitting transaction")}finally{u(!1)}},B=async()=>{o(!0);try{let b=new URLSearchParams;Object.entries(v).forEach(([a,c])=>{c&&"ALL"!==c&&b.append(a,c)});let c=await fetch(`https://varahasdc.co.in/api/inventory/transactions?${b}`);if(c.ok){let b=await c.json();b.success?(k(b.data||[]),b.data&&b.data.length>0&&a.success(`Found ${b.data.length} transactions`)):a.error("Failed to fetch transactions")}else a.error("Failed to fetch transactions")}catch(b){console.error("Error fetching transactions:",b),a.error("Network error while fetching transactions")}finally{o(!1)}};return(0,b.jsx)(h.default,{title:"Inventory Transactions",subtitle:"Track inward and outward stock movements",children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center mb-4",children:[(0,b.jsx)(e.Filter,{className:"h-5 w-5 text-gray-600 mr-2"}),(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Filters"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,b.jsxs)("select",{value:v.type,onChange:a=>w(b=>({...b,type:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"ALL",children:"All Types"}),(0,b.jsx)("option",{value:"INWARD",children:"Inward"}),(0,b.jsx)("option",{value:"OUTWARD",children:"Outward"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item"}),(0,b.jsxs)("select",{value:v.item_id,onChange:a=>w(b=>({...b,item_id:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",children:[(0,b.jsx)("option",{value:"",children:"All Items"}),l.map(a=>(0,b.jsx)("option",{value:a.id,children:a.item_name},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),(0,b.jsx)("input",{type:"text",placeholder:"DD-MM-YYYY",value:v.from_date,onChange:a=>{let b=a.target.value.replace(/\D/g,"");b.length>=2&&(b=b.slice(0,2)+"-"+b.slice(2)),b.length>=5&&(b=b.slice(0,5)+"-"+b.slice(5,9)),w(a=>({...a,from_date:b}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",maxLength:10})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),(0,b.jsx)("input",{type:"text",placeholder:"DD-MM-YYYY",value:v.to_date,onChange:a=>{let b=a.target.value.replace(/\D/g,"");b.length>=2&&(b=b.slice(0,2)+"-"+b.slice(2)),b.length>=5&&(b=b.slice(0,5)+"-"+b.slice(5,9)),w(a=>({...a,to_date:b}))},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",maxLength:10})]}),(0,b.jsx)("div",{className:"flex items-end space-x-2",children:(0,b.jsx)("button",{onClick:B,disabled:n,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50",children:n?"Loading...":"Apply"})})]})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex space-x-3",children:[(0,b.jsxs)("button",{onClick:()=>{s("INWARD"),q(!0)},className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center",children:[(0,b.jsx)(f.TrendingUp,{className:"h-4 w-4 mr-2"}),"Add Inward"]}),(0,b.jsxs)("button",{onClick:()=>{s("OUTWARD"),q(!0)},className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 flex items-center",children:[(0,b.jsx)(g.TrendingDown,{className:"h-4 w-4 mr-2"}),"Add Outward"]})]}),(0,b.jsxs)("button",{onClick:()=>{try{if(0===j.length)return void a.error("No data to export");let b=v.from_date&&v.to_date?`${v.from_date} to ${v.to_date}`:"All Dates",c="ALL"!==v.type?v.type:"All Types",d='<html><meta http-equiv="Content-Type" content="text/html; charset=Windows-1252"><body>';d+=`<table border="1" style="border-collapse: collapse; width: 100%;"><tr><th colspan="12" style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px;">VARAHA SDC : 256 SLICE CT SCAN</th></tr><tr><th colspan="12" style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px;">INVENTORY TRANSACTIONS REPORT</th></tr><tr><th colspan="12" style="background-color:#FFEA00; color:black; text-align:center; font-weight:bold; padding:8px;">Date Range: ${b} | Type: ${c}</th></tr><tr><th colspan="12" style="text-align:center; padding:4px;">&nbsp;</th></tr><tr><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">S.No</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Item Name</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Type</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Quantity</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Unit</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Rate</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Amount</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Supplier</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Department</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Invoice/Purpose</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Date</th><th style="background-color:#2F75B5; color:white; text-align:center; font-weight:bold; padding:8px; border:1px solid black;">Remarks</th></tr>`;let e=0;j.forEach((a,b)=>{e+=parseFloat(String(a.total_amount||0)),d+=`<tr><td style="text-align:center; padding:4px; border:1px solid black;">${b+1}</td><td style="text-align:left; padding:4px; border:1px solid black;">${a.item_name}</td><td style="text-align:center; padding:4px; border:1px solid black;">${a.transaction_type}</td><td style="text-align:right; padding:4px; border:1px solid black;">${a.quantity}</td><td style="text-align:center; padding:4px; border:1px solid black;">${a.unit}</td><td style="text-align:right; padding:4px; border:1px solid black;">${a.rate||0}</td><td style="text-align:right; padding:4px; border:1px solid black;">${a.total_amount||0}</td><td style="text-align:left; padding:4px; border:1px solid black;">${a.supplier||""}</td><td style="text-align:left; padding:4px; border:1px solid black;">${a.department||""}</td><td style="text-align:left; padding:4px; border:1px solid black;">${a.invoice_no||a.purpose||""}</td><td style="text-align:center; padding:4px; border:1px solid black;">${a.transaction_date}</td><td style="text-align:left; padding:4px; border:1px solid black;">${a.remarks||""}</td></tr>`}),d+=`<tr><th colspan="6" style="background-color:#FFEA00; color:black; text-align:right; font-weight:bold; padding:8px; border:1px solid black;">TOTAL</th><th style="background-color:#FFEA00; color:black; text-align:right; font-weight:bold; padding:8px; border:1px solid black;">${e.toFixed(2)}</th><th colspan="5" style="background-color:#FFEA00; color:black; padding:8px; border:1px solid black;">&nbsp;</th></tr></table></body></html>`;let f=new Blob([d],{type:"application/vnd.ms-excel"}),g=window.URL.createObjectURL(f),h=document.createElement("a");h.href=g,h.download=`INVENTORY-TRANSACTIONS-${b.replace(/\s+/g,"-")}.xls`,h.click(),window.URL.revokeObjectURL(g),a.success("Transactions exported successfully")}catch(b){console.error("Export error:",b),a.error("Error exporting transactions")}},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center",children:[(0,b.jsx)(d.Download,{className:"h-4 w-4 mr-2"}),"Export Excel"]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:["Transactions (",j.length,")"]})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"S.No"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Item"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Rate"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Details"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:n?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center",children:"Loading..."})}):0===j.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:8,className:"px-6 py-8 text-center text-gray-500",children:"No transactions found"})}):j.map((a,c)=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:c+1}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.item_name}),(0,b.jsx)("td",{className:"px-6 py-4",children:(0,b.jsx)("span",{className:`px-2 py-1 text-xs rounded-full ${"INWARD"===a.transaction_type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.transaction_type})}),(0,b.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:[a.quantity," ",a.unit]}),(0,b.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:["₹",a.rate||0]}),(0,b.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:["₹",a.total_amount||0]}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:"INWARD"===a.transaction_type?`${a.supplier||"N/A"} (${a.invoice_no||"No Invoice"})`:`${a.department||"N/A"} - ${a.issued_to||"N/A"} (${a.purpose||"N/A"})`}),(0,b.jsx)("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.transaction_date})]},a.id))})]})})]}),p&&(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("h3",{className:"text-lg font-semibold mb-4",children:["Add ",r," Transaction"]}),(0,b.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item *"}),(0,b.jsxs)("select",{value:x.item_id,onChange:a=>y(b=>({...b,item_id:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",required:!0,children:[(0,b.jsx)("option",{value:"",children:"Select Item"}),l.map(a=>(0,b.jsxs)("option",{value:a.id,children:[a.item_name," (Stock: ",a.quantity," ",a.unit,")"]},a.id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantity *"}),(0,b.jsx)("input",{type:"number",min:"1",value:x.quantity,onChange:a=>y(b=>({...b,quantity:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",required:!0})]}),"INWARD"===r?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rate per Unit"}),(0,b.jsx)("input",{type:"number",step:"0.01",min:"0",value:x.rate,onChange:a=>y(b=>({...b,rate:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),(0,b.jsx)("input",{type:"text",value:x.supplier,onChange:a=>y(b=>({...b,supplier:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",placeholder:"Supplier name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice No"}),(0,b.jsx)("input",{type:"text",value:x.invoice_no,onChange:a=>y(b=>({...b,invoice_no:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",placeholder:"Invoice number"})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,b.jsx)("input",{type:"text",value:x.department,onChange:a=>y(b=>({...b,department:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",placeholder:"Department name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issued To"}),(0,b.jsx)("input",{type:"text",value:x.issued_to,onChange:a=>y(b=>({...b,issued_to:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",placeholder:"Person name"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purpose"}),(0,b.jsx)("input",{type:"text",value:x.purpose,onChange:a=>y(b=>({...b,purpose:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",placeholder:"Purpose of issue"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remarks"}),(0,b.jsx)("textarea",{value:x.remarks,onChange:a=>y(b=>({...b,remarks:a.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500",rows:2,placeholder:"Additional remarks"})]}),(0,b.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,b.jsx)("button",{type:"button",onClick:()=>q(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",disabled:t,children:"Cancel"}),(0,b.jsx)("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",disabled:t,children:t?"Saving...":"Save Transaction"})]})]})]})})]})})}}];

//# sourceMappingURL=src_app_inventory_transactions_page_tsx_e55ec378._.js.map