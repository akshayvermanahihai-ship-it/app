module.exports=[98537,a=>{"use strict";a.s(["default",()=>k]);var b=a.i(87924),c=a.i(72131),d=a.i(87532),e=a.i(69520),f=a.i(24569),g=a.i(210),h=a.i(14548),i=a.i(66632),j=a.i(50944);function k(){let a=(0,i.useToastContext)(),k=(0,j.useRouter)(),l=(0,j.useSearchParams)().get("edit"),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(!0),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(new Date().toLocaleDateString("en-CA",{timeZone:"Asia/Calcutta"})),[u,v]=(0,c.useState)(1),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),A=a=>a&&"-"!==a?a.includes("T")?new Date(a).toLocaleDateString("en-GB",{timeZone:"Asia/Calcutta"}).replace(/\//g,"-"):a.match(/^\d{4}-\d{2}-\d{2}$/)?a.split("-").reverse().join("-"):(a.match(/^\d{2}-\d{2}-\d{4}$/),a):"-",B=a=>{if(!a||"-"===a)return"";if(a.includes("T"))return a.split("T")[0];if(a.match(/^\d{2}-\d{2}-\d{4}$/)){let b=a.split("-");return`${b[2]}-${b[1]}-${b[0]}`}return a};(0,c.useEffect)(()=>{C()},[s]),(0,c.useEffect)(()=>{if(l&&m.length>0){let a=m.find(a=>a.con_id.toString()===l);a&&x({...a,date:B(a.date),scan_date:B(a.scan_date),allot_date:B(a.allot_date),added_on:B(a.added_on),number_film:a.number_film?.toString()||a.number_films?.toString()||""})}},[l,m]);let C=async()=>{p(!0);try{let b=new URLSearchParams({fromDate:s.split("-").reverse().join("-"),toDate:s.split("-").reverse().join("-")}),c=await fetch(`https://varahasdc.co.in/api/console/detail-report?${b}`,{cache:"no-cache",headers:{"Cache-Control":"no-cache"}});if(c.ok){let b=await c.json();n(b.data||[]),b.data&&b.data.length>0?a.success(`Found ${b.data.length} console records`):a.error("No console records found for selected date")}else a.error("Failed to fetch console records")}catch(b){console.error("Error fetching records:",b),a.error("Error loading console records")}finally{p(!1)}},D=async()=>{if(w){z(!0);try{let b=await fetch("https://varahasdc.co.in/api/console/update-console",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({con_id:w.con_id,scan_date:w.scan_date,allot_date:w.allot_date,date:w.date,examination_id:w.examination_id,status:w.status,number_scan:w.number_scan,number_films:w.number_film,number_contrast:w.number_contrast,technician_name:w.technician_name,issue_cd:w.issue_cd})});if(b.ok)a.success("Console record updated successfully"),await C(),k.push("/console/update");else{let c=await b.json();a.error(c.error||"Failed to update console record")}}catch(b){console.error("Error updating record:",b),a.error("Error updating console record")}finally{z(!1)}}},E=m.filter(a=>a.c_p_cro.toLowerCase().includes(q.toLowerCase())||a.patient_name.toLowerCase().includes(q.toLowerCase())),F=E.slice((u-1)*10,10*u),G=Math.ceil(E.length/10);return((0,c.useEffect)(()=>{v(1)},[q,s]),l&&w)?(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white p-6 rounded-xl shadow-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("button",{onClick:()=>{k.push("/console/update")},className:"p-2 bg-sky-500 hover:bg-sky-400 rounded-lg transition-colors",children:(0,b.jsx)(g.ArrowLeft,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Edit Console Record"}),(0,b.jsxs)("p",{className:"text-sky-100",children:["CRO: ",w.c_p_cro]})]})]}),(0,b.jsxs)("button",{onClick:D,disabled:y,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors disabled:opacity-50",children:[(0,b.jsx)(h.Save,{className:`h-5 w-5 ${y?"animate-spin":""}`}),(0,b.jsx)("span",{children:y?"Saving...":"Save Changes"})]})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Patient Information"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CRO Number"}),(0,b.jsx)("input",{type:"text",value:w.c_p_cro,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Name"}),(0,b.jsx)("input",{type:"text",value:`${w.pre} ${w.patient_name}`,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctor"}),(0,b.jsx)("input",{type:"text",value:w.doctor_name||"-",readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Console Details (Editable)"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Examination ID"}),(0,b.jsx)("input",{type:"number",value:w.examination_id||"",onChange:a=>x({...w,examination_id:parseInt(a.target.value)||0}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,b.jsxs)("select",{value:w.status||"",onChange:a=>x({...w,status:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"",children:"Select Status"}),(0,b.jsx)("option",{value:"Pending",children:"Pending"}),(0,b.jsx)("option",{value:"In Progress",children:"In Progress"}),(0,b.jsx)("option",{value:"Complete",children:"Complete"}),(0,b.jsx)("option",{value:"Cancelled",children:"Cancelled"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Scans"}),(0,b.jsx)("input",{type:"number",value:w.number_scan||"",onChange:a=>x({...w,number_scan:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Films"}),(0,b.jsx)("input",{type:"number",value:w.number_film||"",onChange:a=>x({...w,number_film:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Contrast"}),(0,b.jsx)("input",{type:"number",value:w.number_contrast||"",onChange:a=>x({...w,number_contrast:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Technician Name"}),(0,b.jsx)("input",{type:"text",value:w.technician_name||"",onChange:a=>x({...w,technician_name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue CD/DVD"}),(0,b.jsxs)("select",{value:w.issue_cd||"",onChange:a=>x({...w,issue_cd:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"",children:"Select Option"}),(0,b.jsx)("option",{value:"Yes",children:"Yes"}),(0,b.jsx)("option",{value:"No",children:"No"})]})]})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Editable Date Settings"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Registration Date"}),(0,b.jsx)("input",{type:"date",value:w.date,onChange:a=>x({...w,date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Allot Date"}),(0,b.jsx)("input",{type:"date",value:w.allot_date,onChange:a=>x({...w,allot_date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scan Date"}),(0,b.jsx)("input",{type:"date",value:w.scan_date,onChange:a=>x({...w,scan_date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Console Date & Time (Read Only)"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Console Date"}),(0,b.jsx)("input",{type:"text",value:A(w.added_on),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),(0,b.jsx)("input",{type:"time",value:w.start_time,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stop Time"}),(0,b.jsx)("input",{type:"time",value:w.stop_time,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}):(0,b.jsxs)("div",{className:"p-3 sm:p-6 space-y-4 sm:space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white p-4 sm:p-6 rounded-xl shadow-lg",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-xl sm:text-3xl font-bold mb-2",children:"Console Update"}),(0,b.jsx)("p",{className:"text-sky-100 text-sm sm:text-base",children:"Update console records after completion"})]}),(0,b.jsxs)("button",{onClick:C,disabled:o,className:"flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 bg-sky-500 hover:bg-sky-400 rounded-lg transition-colors disabled:opacity-50 text-sm sm:text-base",children:[(0,b.jsx)(e.RefreshCw,{className:`h-4 w-4 sm:h-5 sm:w-5 ${o?"animate-spin":""}`}),(0,b.jsx)("span",{children:"Refresh"})]})]})}),(0,b.jsx)("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-lg border border-gray-100",children:(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-end space-y-4 sm:space-y-0 sm:space-x-4",children:[(0,b.jsxs)("div",{className:"flex-shrink-0",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),(0,b.jsx)("input",{type:"date",value:s,onChange:a=>t(a.target.value),className:"px-3 py-2 w-full sm:w-auto border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent text-sm sm:text-base"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Search,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,b.jsx)("input",{type:"text",placeholder:"Search by CRO or Patient Name...",value:q,onChange:a=>r(a.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent text-sm sm:text-base"})]})]})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-gray-200",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Console Records"}),(0,b.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:["Date: ",s.split("-").reverse().join("-")," | Total: ",E.length," records | Page ",u," of ",G]})]}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"CRO"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient Name"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Registration Date"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Allot Date"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Scan Date"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Console Date"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Time"}),(0,b.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,b.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:o?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:10,className:"px-6 py-12 text-center",children:(0,b.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[(0,b.jsx)(e.RefreshCw,{className:"h-5 w-5 animate-spin text-sky-500"}),(0,b.jsx)("span",{className:"text-gray-500",children:"Loading console records..."})]})})}):0===E.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:10,className:"px-6 py-12 text-center text-gray-500",children:"No console records found"})}):F.map(a=>(0,b.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("div",{className:"text-sm font-medium text-sky-600",children:a.c_p_cro})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsxs)("div",{className:"text-sm font-medium text-black",children:[a.pre," ",a.patient_name]})}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:a.doctor_name||"-"}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:A(a.date)}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:A(a.allot_date)}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:A(a.scan_date)}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:A(a.added_on)}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsx)("span",{className:`px-3 py-1 text-xs font-bold rounded-full border ${"Complete"===a.status?"bg-green-100 text-green-900 border-green-300":"Pending"===a.status?"bg-yellow-100 text-yellow-900 border-yellow-300":"bg-gray-100 text-gray-900 border-gray-300"}`,children:a.status})}),(0,b.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-black",children:[a.start_time," - ",a.stop_time]}),(0,b.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,b.jsxs)("button",{onClick:()=>{k.push(`/console/update?edit=${a.con_id}`)},className:"inline-flex items-center space-x-1 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors text-sm font-medium",children:[(0,b.jsx)(f.Edit,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Edit"})]})})]},a.con_id))})]})}),E.length>10&&(0,b.jsx)("div",{className:"px-6 py-4 border-t border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"text-sm text-gray-700",children:["Page ",u," of ",G," | Total: ",E.length," records"]}),(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[u>1&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>v(1),className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"First"}),(0,b.jsx)("button",{onClick:()=>v(u-1),className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Previous"})]}),(0,b.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(5,G)},(a,c)=>{let d=Math.max(1,u-2)+c;return d>G?null:(0,b.jsx)("button",{onClick:()=>v(d),className:`px-3 py-2 text-sm font-medium rounded-lg ${u===d?"bg-sky-600 text-white":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:d},d)})}),u<G&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:()=>v(u+1),className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Next"}),(0,b.jsx)("button",{onClick:()=>v(G),className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Last"})]})]})]})})]})]})}}];

//# sourceMappingURL=src_app_console_update_page_tsx_8d6ba2ee._.js.map