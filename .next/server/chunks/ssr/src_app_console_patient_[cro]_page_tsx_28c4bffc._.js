module.exports=[77137,a=>{"use strict";a.s(["default",()=>g]);var b=a.i(87924),c=a.i(72131),d=a.i(210),e=a.i(66632),f=a.i(50944);function g({params:a}){let g=(0,e.useToastContext)(),h=(0,f.useRouter)(),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta"})),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)({examination_id:"",number_scan:"",number_film:"",number_contrast:"",technician_name:"",nursing_name:"",issue_cd:"NO",remark:"",console_date:new Date().toLocaleDateString("en-CA"),console_time:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1})});(0,c.useEffect)(()=>{a.then(a=>t(decodeURIComponent(a.cro)))},[a]),(0,c.useEffect)(()=>{s&&w();let a=setInterval(()=>{r(new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta"}))},1e3);return()=>clearInterval(a)},[s]);let w=async()=>{l(!0);try{let a=await fetch(`/api/console/patient/${encodeURIComponent(s)}`);if(a.ok){let b=await a.json();if(j(b.data),b.data.console){let a=b.data.console;v({examination_id:a.examination_id||"",number_scan:a.number_scan||"",number_film:a.number_films||"",number_contrast:a.number_contrast||"",technician_name:a.technician_name||"",nursing_name:a.nursing_name||"",issue_cd:a.issue_cd||"NO",remark:a.remark||"",console_date:new Date().toLocaleDateString("en-CA"),console_time:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1})}),n(a.start_time||""),p(a.stop_time||"")}}else{let b=await a.json().catch(()=>({}));console.error("Console patient API error:",b),g.error(`API Error: ${b.error||"Failed to fetch patient data"}. Details: ${b.details||"Unknown error"}`)}}catch(a){console.error("Error fetching patient data:",a),g.error("Error loading patient data")}finally{l(!1)}},x=async(a,b)=>{try{(await fetch("/api/console/update-scan-status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scan_id:a,patient_id:s,status:b})})).ok?(w(),g.success("Scan status updated")):g.error("Failed to update scan status")}catch(a){console.error("Error updating scan status:",a),g.error("Error updating scan status")}},y=async a=>{try{if(!u.examination_id)return void g.error("Please enter Examination ID");let b=a;"Complete"===a&&(b="Complete");let c=await fetch("https://varahasdc.co.in/api/console/save-console",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cro:s,start_time:m,stop_time:o,status:b,...u})});if(c.ok)await c.json(),"Complete"===a?(g.success("Console completed successfully!"),h.push("/console")):"Pending"===a&&(g.success("Console marked as pending"),h.push("/console"));else{let a=await c.json().catch(()=>({}));g.error(`Failed to save console data: ${a.error||"Unknown error"}`)}}catch(a){console.error("Error saving console data:",a),g.error("Error saving console data")}};if(k)return(0,b.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-sky-600 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading patient data..."})]})});if(!i)return(0,b.jsxs)("div",{className:"p-6 text-center",children:[(0,b.jsx)("p",{className:"text-red-600",children:"Patient not found"}),(0,b.jsx)("button",{onClick:()=>h.push("/console"),className:"mt-4 px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700",children:"Back to Queue"})]});let z=i.scans.every(a=>"complete"===a.status);return i.scans.filter(a=>"pending"===a.status).length,(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 text-white p-6 rounded-xl shadow-lg",children:(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,b.jsx)("button",{onClick:()=>h.push("/console"),className:"p-2 bg-sky-500 hover:bg-sky-400 rounded-lg transition-colors",children:(0,b.jsx)(d.ArrowLeft,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-3xl font-bold mb-2",children:["Console - ",s]}),(0,b.jsx)("p",{className:"text-sky-100",children:"Patient examination console"})]})]})})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Patient History"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Console Date Of Examination"}),(0,b.jsx)("input",{type:"text",value:new Date().toLocaleDateString("en-GB").replace(/\//g,"-"),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Console Time"}),(0,b.jsx)("input",{type:"text",value:new Date().toLocaleTimeString("en-IN",{timeZone:"Asia/Calcutta",hour12:!1}),readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CRO Number"}),(0,b.jsx)("input",{type:"text",value:i.patient.cro,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Patient Name"}),(0,b.jsx)("input",{type:"text",value:`${i.patient.pre} ${i.patient.patient_name}`,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Age"}),(0,b.jsx)("input",{type:"text",value:i.patient.age,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Doctor"}),(0,b.jsx)("input",{type:"text",value:i.patient.doctor_name,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,b.jsx)("input",{type:"text",value:i.patient.category,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact"}),(0,b.jsx)("input",{type:"text",value:i.patient.contact_number,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Timer"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time"}),(0,b.jsx)("button",{onClick:()=>{n(q)},className:"w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-lg font-mono",children:m||q})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stop Time"}),(0,b.jsx)("button",{onClick:()=>{p(q)},className:"w-full px-4 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-lg font-mono",children:o||q})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"MRI Details"}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"w-full",children:[(0,b.jsx)("thead",{className:"bg-gray-50",children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"S.No"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"MRI NAME"}),(0,b.jsx)("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Action"})]})}),(0,b.jsx)("tbody",{className:"divide-y divide-gray-200",children:i.scans.map((a,c)=>(0,b.jsxs)("tr",{children:[(0,b.jsx)("td",{className:"px-4 py-4 text-sm text-black font-medium",children:c+1}),(0,b.jsx)("td",{className:"px-4 py-4 text-sm font-medium text-black",children:a.s_name}),(0,b.jsx)("td",{className:"px-4 py-4",children:(0,b.jsxs)("div",{className:"flex space-x-4",children:[(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"radio",name:`scan_${a.s_id||a.scan_id||c}`,checked:"pending"===a.status,onChange:()=>x(a.scan_id,"pending"),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Pending"})]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"radio",name:`scan_${a.s_id||a.scan_id||c}`,checked:"complete"===a.status,onChange:()=>x(a.scan_id,"complete"),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm text-gray-700",children:"Complete"})]})]})})]},a.s_id||a.scan_id||c))})]})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Console Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Examination ID ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)("input",{type:"number",value:u.examination_id,onChange:a=>v({...u,examination_id:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Scans"}),(0,b.jsx)("input",{type:"number",value:u.number_scan,onChange:a=>v({...u,number_scan:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Films"}),(0,b.jsx)("input",{type:"number",value:u.number_film,onChange:a=>v({...u,number_film:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Contrast"}),(0,b.jsx)("input",{type:"number",value:u.number_contrast,onChange:a=>v({...u,number_contrast:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Technician Name"}),(0,b.jsx)("input",{type:"text",value:u.technician_name,onChange:a=>v({...u,technician_name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nursing Name"}),(0,b.jsx)("input",{type:"text",value:u.nursing_name,onChange:a=>v({...u,nursing_name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Issue CD/DVD"}),(0,b.jsxs)("select",{value:u.issue_cd,onChange:a=>v({...u,issue_cd:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent",children:[(0,b.jsx)("option",{value:"NO",children:"NO"}),(0,b.jsx)("option",{value:"YES",children:"YES"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Remark"}),(0,b.jsx)("textarea",{value:u.remark,onChange:a=>v({...u,remark:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-sky-500 focus:border-transparent"})]})]})]}),(0,b.jsxs)("div",{className:"flex justify-center space-x-4",children:[z?(0,b.jsx)("button",{onClick:()=>y("Complete"),className:"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium shadow-lg",children:"Complete"}):(0,b.jsx)("button",{onClick:()=>y("Pending"),className:"px-8 py-3 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium shadow-lg",children:"Pending"}),(0,b.jsx)("button",{onClick:()=>{window.confirm("You Click On Recall Button, Patient Data Is Not Save And Patient Is Sent On Reception Table")&&(g.info("Patient recalled to reception"),h.push("/console"))},className:"px-8 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium shadow-lg",children:"Recall"})]})]})}}];

//# sourceMappingURL=src_app_console_patient_%5Bcro%5D_page_tsx_28c4bffc._.js.map