module.exports=[26428,a=>{"use strict";a.s(["default",()=>n]);var b=a.i(87924),c=a.i(65402),d=a.i(55957),e=a.i(18604),f=a.i(72131),g=a.i(41710),h=a.i(4720),i=a.i(46842),j=a.i(14548),k=a.i(71931),l=a.i(33508),m=a.i(50944);function n(){let a=(0,m.useParams)().role,[n,o]=(0,f.useState)(1),[p,q]=(0,f.useState)(!1),[r,s]=(0,f.useState)([]),[t,u]=(0,f.useState)([]),[v,w]=(0,f.useState)([]),[x,y]=(0,f.useState)(null),{toast:z,showToast:A,hideToast:B}=(0,e.useToast)(),[C,D]=(0,f.useState)({cro:"",date:new Date().toISOString().split("T")[0],scan_date:new Date().toISOString().split("T")[0],hospital_name:"",doctor_name:"",pre:"Mr.",firstname:"",age:"",age_type:"Year",gender:"",category:"",address:"",city:"",contact_number:"",scan_types:[],amount:"",est_time:""});(0,f.useEffect)(()=>{E(),F()},[]);let E=async()=>{try{let[a,b,c]=await Promise.all([fetch("/api/hospitals"),fetch("/api/doctors"),fetch("/api/scans")]);s(await a.json()),u(await b.json()),w(await c.json())}catch(a){console.error("Error fetching master data:",a)}},F=async()=>{try{let a=await fetch("/api/patients?last=true"),b=await a.json();b&&b.length>0&&y(b[0])}catch(a){console.error("Error fetching last patient:",a)}},G=async()=>{try{let a=await fetch("/api/patients/cro",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:C.date})}),b=await a.json();D(a=>({...a,cro:b.cro}))}catch(a){console.error("Error generating CRO:",a)}};(0,f.useEffect)(()=>{C.date&&G()},[C.date]);let H=(a,b)=>{D(c=>({...c,[a]:b}))},I=async()=>{if(0!==C.scan_types.length)try{let a=await fetch("/api/scans/calculate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({scan_ids:C.scan_types})}),b=await a.json();D(a=>({...a,amount:b.total_amount,est_time:b.estimated_time}))}catch(a){console.error("Error calculating scan details:",a)}};(0,f.useEffect)(()=>{I()},[C.scan_types]);let J=async()=>{q(!0);try{(await fetch("/api/patients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...C,page_type:"patient_back",admin_id:1})})).ok?(A("Patient registered successfully with back entry!","success"),F(),D({cro:"",date:new Date().toISOString().split("T")[0],scan_date:new Date().toISOString().split("T")[0],hospital_name:"",doctor_name:"",pre:"Mr.",firstname:"",age:"",age_type:"Year",gender:"",category:"",address:"",city:"",contact_number:"",scan_types:[],amount:"",est_time:""}),o(1)):A("Error registering patient","error")}catch(a){console.error("Error submitting form:",a),A("Error registering patient","error")}finally{q(!1)}};return(0,b.jsx)(c.default,{children:(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-lg p-6",children:(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Patient Registration Back Entry - ",a]}),x&&(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,b.jsx)("span",{className:"font-medium",children:"Last Entry:"})," ",x.cro," - ",x.patient_name]})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl p-6",children:[(0,b.jsx)("ul",{className:"flex border-b border-gray-200 mb-6",children:[{step:1,title:"1. Enrollment Detail",icon:i.User},{step:2,title:"2. Scan Options",icon:h.FileText},{step:3,title:"3. Payment Details",icon:g.Clock}].map(({step:a,title:c,icon:d})=>(0,b.jsx)("li",{className:"flex-1",children:(0,b.jsxs)("button",{onClick:()=>o(a),className:`w-full flex items-center justify-center px-4 py-3 text-sm font-medium border-b-2 transition-colors ${n===a?"border-sky-500 text-sky-600 bg-sky-50":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[(0,b.jsx)(d,{className:"h-4 w-4 mr-2"}),c]})},a))}),(0,b.jsxs)("div",{className:"min-h-96",children:[1===n&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CRO No."}),(0,b.jsx)("input",{type:"text",value:C.cro,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Registration Date"}),(0,b.jsx)("input",{type:"date",value:C.date,onChange:a=>H("date",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scan Date"}),(0,b.jsx)("input",{type:"date",value:C.scan_date,onChange:a=>H("scan_date",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hospital Name"}),(0,b.jsxs)("select",{value:C.hospital_name,onChange:a=>H("hospital_name",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Select Hospital"}),r.map(a=>(0,b.jsx)("option",{value:a.h_id,children:a.h_short},a.h_id))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Doctor Name"}),(0,b.jsxs)("select",{value:C.doctor_name,onChange:a=>H("doctor_name",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Select Doctor"}),t.map(a=>(0,b.jsx)("option",{value:a.d_id,children:a.dname},a.d_id))]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Title"}),(0,b.jsxs)("select",{value:C.pre,onChange:a=>H("pre",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"Mr.",children:"Mr."}),(0,b.jsx)("option",{value:"Mrs.",children:"Mrs."}),(0,b.jsx)("option",{value:"Master",children:"Master"}),(0,b.jsx)("option",{value:"Miss",children:"Miss"}),(0,b.jsx)("option",{value:"Baby",children:"Baby"})]})]}),(0,b.jsxs)("div",{className:"md:col-span-10",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patient Name"}),(0,b.jsx)("input",{type:"text",value:C.firstname,onChange:a=>H("firstname",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter patient name"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age"}),(0,b.jsx)("input",{type:"number",value:C.age,onChange:a=>H("age",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Age Type"}),(0,b.jsxs)("select",{value:C.age_type,onChange:a=>H("age_type",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"Year",children:"Year"}),(0,b.jsx)("option",{value:"Month",children:"Month"}),(0,b.jsx)("option",{value:"Days",children:"Days"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Gender"}),(0,b.jsxs)("select",{value:C.gender,onChange:a=>H("gender",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Select"}),(0,b.jsx)("option",{value:"Male",children:"Male"}),(0,b.jsx)("option",{value:"Female",children:"Female"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category"}),(0,b.jsxs)("select",{value:C.category,onChange:a=>H("category",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[(0,b.jsx)("option",{value:"",children:"Select"}),(0,b.jsx)("option",{value:"GEN",children:"GEN"}),(0,b.jsx)("option",{value:"BPL/POOR",children:"BPL/POOR"}),(0,b.jsx)("option",{value:"Sn. CITIZEN",children:"Sn. CITIZEN"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),(0,b.jsx)("input",{type:"text",value:C.address,onChange:a=>H("address",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter address"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),(0,b.jsx)("input",{type:"text",value:C.city,onChange:a=>H("city",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter city"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Number"}),(0,b.jsx)("input",{type:"tel",value:C.contact_number,onChange:a=>H("contact_number",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"Enter contact number"})]})]}),2===n&&(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scan Type"}),(0,b.jsx)("select",{multiple:!0,value:C.scan_types,onChange:a=>{H("scan_types",Array.from(a.target.selectedOptions,a=>a.value))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg h-32",children:v.map(a=>(0,b.jsx)("option",{value:a.s_id,children:a.s_name},a.s_id))}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Hold Ctrl/Cmd to select multiple scans"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount"}),(0,b.jsx)("input",{type:"number",value:C.amount,onChange:a=>H("amount",a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estimated Time"}),(0,b.jsx)("input",{type:"text",value:C.est_time,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",placeholder:"Auto calculated"})]})]})]}),3===n&&(0,b.jsx)("div",{className:"space-y-6",children:(0,b.jsxs)("div",{className:"bg-white border rounded-lg p-6",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Invoice Summary"}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Patient Name:"}),(0,b.jsxs)("span",{className:"font-medium",children:[C.pre," ",C.firstname]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Age:"}),(0,b.jsxs)("span",{children:[C.age," ",C.age_type]})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Gender:"}),(0,b.jsx)("span",{children:C.gender})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Address:"}),(0,b.jsx)("span",{children:C.address})]}),(0,b.jsx)("hr",{}),(0,b.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,b.jsx)("span",{children:"Total Amount:"}),(0,b.jsxs)("span",{children:["â‚¹",C.amount]})]})]})]})})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center mt-8 pt-6 border-t",children:[(0,b.jsx)("div",{className:"flex space-x-2",children:n>1&&(0,b.jsx)("button",{onClick:()=>o(n-1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Previous"})}),(0,b.jsx)("div",{className:"flex space-x-2",children:n<3?(0,b.jsx)("button",{onClick:()=>o(n+1),className:"px-4 py-2 bg-sky-500 text-white rounded-lg hover:bg-sky-600",children:"Next"}):(0,b.jsxs)("div",{className:"flex space-x-2",children:[(0,b.jsxs)(d.FormButton,{onClick:J,disabled:p,children:[(0,b.jsx)(j.Save,{className:"h-4 w-4 mr-2"}),p?"Saving...":"Save"]}),(0,b.jsxs)(d.FormButton,{onClick:()=>{J()},disabled:p,className:"bg-green-500 hover:bg-green-600",children:[(0,b.jsx)(k.Printer,{className:"h-4 w-4 mr-2"}),"Save & Print"]}),(0,b.jsxs)("button",{onClick:()=>o(1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[(0,b.jsx)(l.X,{className:"h-4 w-4 mr-2"}),"Exit"]})]})})]})]}),(0,b.jsx)(e.Toast,{message:z.message,type:z.type,isVisible:z.isVisible,onClose:B})]})})}}];

//# sourceMappingURL=src_app_%5Brole%5D_patient-registration_back-entry_page_tsx_2d9628aa._.js.map