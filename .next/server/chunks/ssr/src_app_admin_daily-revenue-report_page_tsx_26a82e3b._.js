module.exports=[49223,a=>{"use strict";a.s(["default",()=>h]);var b=a.i(87924),c=a.i(72131),d=a.i(84505),e=a.i(87532),f=a.i(81464),g=a.i(82651);function h(){let[a,h]=(0,c.useState)([]),[i,j]=(0,c.useState)([]),[k,l]=(0,c.useState)(!0),[m,n]=(0,c.useState)(1),[o]=(0,c.useState)(10),[p,q]=(0,c.useState)(""),[r,s]=(0,c.useState)((()=>{let a=new Date,b=String(a.getDate()).padStart(2,"0"),c=String(a.getMonth()+1).padStart(2,"0"),d=a.getFullYear();return`${b}-${c}-${d}`})()),[t,u]=(0,c.useState)("D");(0,c.useEffect)(()=>{v()},[r,t]);let v=async()=>{l(!0);try{let a=new URLSearchParams({date:r,type:t}),b=await fetch(`https://varahasdc.co.in/api/admin/daily-revenue-report?${a}`);if(b.ok){let a=await b.json();h(a.data||[])}}catch(a){console.error("Error fetching revenue data:",a)}finally{l(!1)}};(0,c.useEffect)(()=>{let b=[];Array.isArray(a)&&a.forEach(a=>{"D"===t&&a.patients&&Array.isArray(a.patients)?a.patients.forEach(c=>{b.push({...c,hospitalName:a.hospitalName,hospital_name:a.hospitalName})}):"S"===t&&a.summaryRows&&Array.isArray(a.summaryRows)&&a.summaryRows.forEach((c,d)=>{b.push({sno:d+1,date:a.date,cro:c.scanCode,patient_name:`${a.hospitalName} - ${a.category}`,patientName:`${a.hospitalName} - ${a.category}`,age:c.patientCount.toString(),gender:"Summary",scan_names:c.scanNames.filter(a=>".."!==a).join(", "),scanNames:c.scanNames.filter(a=>".."!==a),total_scan:c.numberOfScans,totalScans:c.numberOfScans,amount:c.amount,category:a.category,hospitalName:a.hospitalName,hospital_name:a.hospitalName,mobile:"",doctor:""})})});let c=b;p&&(c=c.filter(a=>(a.patient_name||a.patientName||"").toLowerCase().includes(p.toLowerCase())||(a.cro||"").toLowerCase().includes(p.toLowerCase()))),j(c),n(1)},[a,p,t]);let w=Math.ceil(i.length/o),x=(m-1)*o,y=i.slice(x,x+o),z=async()=>{if(!Array.isArray(a)||0===a.length)return void alert("No data available for export");let b=new Date("2023-06-01"),c=r.split("-"),d=Math.ceil(Math.abs(new Date(`${c[2]}-${c[1]}-${c[0]}`).getTime()-b.getTime())/864e5)+85,e=85===d?"85 (A)":d,f=Math.max(...a.map(a=>a.summaryRows?Math.max(...a.summaryRows.map(a=>a.scanCode.split("+").length)):0)),g=f+5,h=`<html><meta http-equiv="Content-Type" content="text/html; charset=Windows-1252"><body><table border="1"><tr><th colspan="${g}">VARAHA SDC : 256 SLICE CT SCAN</th></tr><tr><th style="text-margin:center;" colspan="${g}">(IMAGING UNDER P.P.P MODE)</th></tr><tr><th style="text-margin:center;" colspan="${g}">RAJASTHAN MEDICARE RELIEF SOCIETY, MDM HOSPITAL , Jodhpur</th></tr><tr><th style="background-color:#FFEA00; color:black;text-align:left;" colspan="${g}">Bill No. :- 2023/VDC_MDM/CT${e}</th></tr><tr><th style="text-align:center;" colspan="${g}">&nbsp;</th></tr><tr><th style="text-align:right;" colspan="${g}">RMRS, MDM Hospital, Jodhpur</th></tr><tr><th style="text-align:right;" colspan="${g}">SUMMARY FOR THE PERIOD OF</th></tr><tr><th style="background-color:#FFEA00; color:black;text-align:right;" colspan="${g}">${r}</th></tr>`,i=0,j=0,k=0;a.forEach(a=>{if(!a.summaryRows||0===a.summaryRows.length)return;let b=Math.max(...a.summaryRows.map(a=>a.scanCode.split("+").length));h+=`<tr><th style="background-color:#FFEA00; color:black">(${a.hospitalName} ${a.category})</th></tr><tr>`;for(let a=1;a<=b;a++)h+=`<th style="background-color:#2F75B5; color:white">${a}. SCAN NAME</th>`;h+='<th style="background-color:#2F75B5; color:white">SCAN NO. ( Scan Code)</th><th style="background-color:#2F75B5; color:white">NO. OF SCAN</th><th style="background-color:#2F75B5; color:white">PATIENT/ FORMS</th><th style="background-color:#2F75B5; color:white">RATE</th><th style="background-color:#2F75B5; color:white">AMOUNT</th></tr>';let c=0,d=0,e=0;a.summaryRows.forEach(a=>{h+="<tr>";for(let c=0;c<b;c++)h+=`<td>${a.scanNames[c]||".."}</td>`;h+=`<td style="text-align:center">${a.scanCode}</td><td style="text-align:center">${a.numberOfScans}</td><td style="text-align:center">${a.patientCount}</td><td style="text-align:center">${a.rate}</td><td style="text-align:right">${a.amount}</td></tr>`,c+=a.numberOfScans,d+=a.patientCount,e+=a.amount}),h+=`<tr><th style="background-color:#FFEA00; color:black; text-align:left" colspan="${b}">Total </th><th style="background-color:#FFEA00; color:black;text-align:center"> </th><th style="background-color:#FFEA00; color:black;text-align:center">${c}</th><th style="background-color:#FFEA00; color:black;text-align:center">${d}</th><th style="background-color:#FFEA00; color:black;text-align:center"> </th><th style="background-color:#FFEA00; color:black;text-align:right">${e.toFixed(2)}</th></tr><tr><th colspan="${b+5}">&nbsp;</th></tr>`,i+=c,j+=d,k+=e});let l=parseFloat((k-.25*k).toFixed(2)),m=0,n=0,o=0;try{let a=await fetch(`https://varahasdc.co.in/api/admin/paid-patients?s_date=${r}`);if(a.ok){let b=await a.json();b.success&&(m=b.tot_patient||0,n=b.tot_scan||0,o=parseFloat((b.tot_amt||0).toFixed(2)))}}catch(a){console.error("Error fetching paid patients data:",a)}h+=`<tr><th style="background-color:#FFEA00; color:black; text-align:left" colspan="${f}">NET AMOUNT</th><th style="background-color:#FFEA00; color:black;text-align:center">${i}</th><th style="background-color:#FFEA00; color:black;text-align:center">${j}</th><th style="background-color:#FFEA00; color:black;text-align:center"> </th><th style="background-color:#FFEA00; color:black;text-align:right">${k.toFixed(2)}</th></tr><tr><th colspan="${g}">&nbsp;</th></tr><tr><th style="background-color:#2F75B5; color:white" colspan="${g}">SUMMARY FOR THE PERIOD</th></tr><tr><td><B>PARTICULAR</td>`;for(let a=1;a<f;a++)h+="<td></td>";h+='<td style="text-align:center"><B>SCAN</td><td></td><td style="text-align:center"><B>AMOUNT</td></tr><tr><td>GROSS TOTAL</td>';for(let a=1;a<f;a++)h+="<td></td>";h+=`<td style="text-align:center">${i}</td><td></td><td style="text-align:right">${k.toFixed(2)}</td></tr><tr><td>(-) 25% FREE SHARE OF MDM</td>`;for(let a=1;a<f;a++)h+="<td></td>";let p=new Blob([h+=`<td style="text-align:center">${parseFloat((.25*i).toFixed(2))}</td><td></td><td style="text-align:right">${(.25*k).toFixed(2)}</td></tr><tr><th colspan="${f}" style="background-color:#FFEA00; color:black; text-align:left">NET RECEIVABLE</th><th style="background-color:#FFEA00; color:black; text-align:center">${parseFloat((i-.25*i).toFixed(2))}</th><th style="background-color:#FFEA00; color:black;"></th><th style="background-color:#FFEA00; color:black;text-align:right">${l.toFixed(2)}</th></tr><tr><th colspan="${g}">&nbsp;</th></tr><tr><th colspan="${g}">&nbsp;</th></tr><tr><th colspan="${f}" style="text-align:left"><u>RUPEES ${(a=>{let b=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],c=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],d=a=>{let d="";return a>=100&&(d+=b[Math.floor(a/100)]+" Hundred ",a%=100),a>=20&&(d+=c[Math.floor(a/10)]+" ",a%=10),a>0&&(d+=b[a]+" "),d};if(0===a)return"Zero Rupees Only";let e=Math.floor(a),f=Math.round((a-e)*100),g="",h=e,i=Math.floor(h/1e7),j=Math.floor((h%=1e7)/1e5),k=Math.floor((h%=1e5)/1e3),l=h%=1e3;return i>0&&(g+=d(i)+"Crore "),j>0&&(g+=d(j)+"Lakh "),k>0&&(g+=d(k)+"Thousand "),l>0&&(g+=d(l)),(g=g.trim())?g+=" Rupees":g="Zero Rupees",f>0&&(g+=" And "+d(f).trim()+" Paisa"),g+" Only"})(l).toUpperCase()}</u></th><th colspan="4"></th></tr><tr><th colspan="${f}" style="text-align:left">*TOTAL PAID PATIENT = ${m}, TOTAL SCAN = ${n}, TOTAL AMOUNT = ${o.toFixed(2)}</th><th colspan="4" style="text-align:right">For : VARAHA SDC</th></tr></table></body></html>`],{type:"application/vnd.ms-excel"}),q=window.URL.createObjectURL(p),s=document.createElement("a");s.href=q,s.download=`DAILY SUMMARY REPORT-${r}.xls`,s.click(),window.URL.revokeObjectURL(q)};return(0,b.jsx)(g.default,{title:"Daily Revenue Report",subtitle:"Daily Revenue Analysis",actions:(0,b.jsxs)(g.Button,{onClick:()=>{"S"===t?z():(()=>{if(!Array.isArray(a)||0===a.length)return alert("No data available for export");let b='<html><meta http-equiv="Content-Type" content="text/html; charset=Windows-1252"><body>';a.forEach(a=>{if(!a.patients||0===a.patients.length)return;let c=Math.max(...a.patients.map(a=>a.total_scan||a.totalScans||0)),d=10+c;console.log("Testing",c,d),b+=`
        <table border="1">
          <tr><th colspan="${d}" style="background-color:#2F75B5; color:white">VARAHA SDC : IMAGING UNDER P.P.P. MODE</th></tr>
          <tr><th colspan="${d}" style="background-color:#2F75B5; color:white">RAJASTHAN MEDICARE RELIEF SOCIETY, MDM HOSPITAL</th></tr>
          <tr><th style="text-margin:center; background-color:#FFEA00; color:black" colspan="${d}">${a.hospitalName} (${a.category}) ${r}</th></tr>
          <tr>
            <th style="background-color:#2F75B5; color:white">S.No</th>
            <th style="background-color:#2F75B5; color:white">DATE</th>
            <th style="background-color:#2F75B5; color:white">CRO NO. / REG. NO.</th>
            <th style="background-color:#2F75B5; color:white">PATIENT ID</th>
            <th style="background-color:#2F75B5; color:white">NAME OF PATIENT</th>
            <th style="background-color:#2F75B5; color:white">AGE</th>
            <th style="background-color:#2F75B5; color:white">GENDER</th>
      `;for(let a=1;a<=c;a++)b+=`<th style="background-color:#2F75B5; color:white">Scan Type ${a}</th>`;b+=`
            <th style="background-color:#2F75B5; color:white">TOTAL SCAN</th>
            <th style="background-color:#2F75B5; color:white">AMOUNT</th>
            <th style="background-color:#2F75B5; color:white">CATEGORY</th>
          </tr>
      `;let e=0,f=0;a.patients.forEach((a,d)=>{let g=a.scanNames||(a.scan_names||a.scan_type||"").split(",").map(a=>a.trim()).filter(a=>a),h=(a.age||"").toString().replace("ear",""),i=(a.gender||"").substring(0,1),j=a.patientId||a.examination_id||a.patient_id||"";b+=`
          <tr>
            <td>${a.sno||d+1}</td>
            <td>${r}</td>
            <td>${a.cro||""}</td>
            <td>${j}</td>
            <td>${a.patientName||a.patient_name||""}</td>
            <td>${h}</td>
            <td>${i}</td>
        `;for(let a=0;a<c;a++){let c=g[a]||"";b+=`<td>${c}</td>`}let k=parseInt(String(a.totalScans||a.total_scan||0)),l=parseFloat(String(a.amount||0));b+=`
            <td style='text-align:right'>${k}</td>
            <td style='text-align:right'>${l.toFixed(2)}</td>
            <td>${a.category}</td>
          </tr>
        `,e+=k,f+=l}),b+=`
        <tr>
          <th style="background-color:#FFEA00; color:black"> </th>
          <th style="background-color:#FFEA00; color:black"> </th>
          <th style="background-color:#FFEA00; color:black"> </th>
          <th style="background-color:#FFEA00; color:black"> </th>
          <th style="background-color:#FFEA00; color:black"></th>
          <th style="background-color:#FFEA00; color:black"></th>
          <th style="background-color:#FFEA00; color:black"></th>
      `;for(let a=1;a<c;a++)b+='<th style="background-color:#FFEA00; color:black"></th>';b+=`
          <th style="background-color:#FFEA00; color:black">Total </th>
          <th style="background-color:#FFEA00; color:black;text-align:right">${e} </th>
          <th style="background-color:#FFEA00; color:black;text-align:right">${f.toFixed(2)}  </th>
          <th style="background-color:#FFEA00; color:black"> </th>
        </tr>
        </table><br><br>
      `});let c=new Blob([b+="</body></html>"],{type:"application/vnd.ms-excel"}),d=window.URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`DAILY REVENUE REPORT-${r}.xls`,e.click(),window.URL.revokeObjectURL(d)})()},variant:"success",disabled:0===a.length,children:[(0,b.jsx)(d.Download,{className:"h-4 w-4 mr-2"}),"Download Excel"]}),children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(g.Card,{className:"p-4",children:[(0,b.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,b.jsx)(f.Filter,{className:"h-5 w-5 text-gray-600"}),(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters & Search"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Date"}),(0,b.jsx)("input",{type:"date",value:r.split("-").reverse().join("-"),onChange:a=>{let b=a.target.value.split("-");s(`${b[2]}-${b[1]}-${b[0]}`)},className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Type"}),(0,b.jsxs)("div",{className:"flex items-center space-x-4 mt-2",children:[(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"radio",name:"reportType",value:"D",checked:"D"===t,onChange:a=>u(a.target.value),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm",children:"Detail"})]}),(0,b.jsxs)("label",{className:"flex items-center",children:[(0,b.jsx)("input",{type:"radio",name:"reportType",value:"S",checked:"S"===t,onChange:a=>u(a.target.value),className:"mr-2"}),(0,b.jsx)("span",{className:"text-sm",children:"Summary"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Search,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,b.jsx)("input",{type:"text",placeholder:"Search CRO or Patient...",value:p,onChange:a=>q(a.target.value),className:"w-full pl-10 pr-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-transparent"})]})]}),(0,b.jsx)("div",{className:"flex items-end",children:(0,b.jsxs)(g.Button,{onClick:v,disabled:k,className:"w-full",children:[(0,b.jsx)(e.Search,{className:"h-4 w-4 mr-2"}),k?"Loading...":"Search"]})})]})]}),(0,b.jsxs)(g.Card,{children:[(0,b.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Revenue Data"}),(0,b.jsxs)("span",{className:"text-sm text-gray-500",children:[i.length," records"]})]})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)(g.Table,{children:[(0,b.jsxs)(g.TableHeader,{children:[(0,b.jsx)(g.TableHeaderCell,{children:"S.No"}),(0,b.jsx)(g.TableHeaderCell,{children:"Date"}),(0,b.jsx)(g.TableHeaderCell,{children:"S"===t?"Scan Code":"CRO"}),(0,b.jsx)(g.TableHeaderCell,{children:"S"===t?"Hospital - Category":"Patient Name"}),(0,b.jsx)(g.TableHeaderCell,{children:"S"===t?"Patient Count":"Age"}),(0,b.jsx)(g.TableHeaderCell,{children:"Gender"}),(0,b.jsx)(g.TableHeaderCell,{children:"Mobile"}),(0,b.jsx)(g.TableHeaderCell,{children:"Category"}),(0,b.jsx)(g.TableHeaderCell,{children:"Hospital"}),(0,b.jsx)(g.TableHeaderCell,{children:"Doctor"}),Array.from({length:Math.max(...i.map(a=>"S"===t&&"scanNames"in a&&a.scanNames?a.scanNames.length:a.total_scan||a.totalScans||0),0)},(a,c)=>(0,b.jsxs)(g.TableHeaderCell,{children:["Scan Type ",c+1]},c)),(0,b.jsx)(g.TableHeaderCell,{children:"Total Scan"}),(0,b.jsx)(g.TableHeaderCell,{children:"Amount"})]}),(0,b.jsx)(g.TableBody,{children:k?(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{className:"text-center",colSpan:13+Math.max(...i.map(a=>"S"===t&&"scanNames"in a&&a.scanNames?a.scanNames.length:a.total_scan||a.totalScans||0),0),children:"Loading..."})}):i&&0!==i.length?y.map((a,c)=>{let d=a.scanNames||(a.scan_names?a.scan_names.split(", "):[])||[];return(0,b.jsxs)(g.TableRow,{children:[(0,b.jsx)(g.TableCell,{children:x+c+1}),(0,b.jsx)(g.TableCell,{children:a.date}),(0,b.jsx)(g.TableCell,{className:"font-medium text-red-600",children:a.cro||""}),(0,b.jsx)(g.TableCell,{children:a.patient_name||a.patientName||""}),(0,b.jsx)(g.TableCell,{children:a.age||""}),(0,b.jsx)(g.TableCell,{children:a.gender||""}),(0,b.jsx)(g.TableCell,{children:a.mobile||""}),(0,b.jsx)(g.TableCell,{children:(0,b.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-blue-100 text-blue-800 font-medium",children:a.category||""})}),(0,b.jsx)(g.TableCell,{children:a.hospitalName||a.hospital_name||""}),(0,b.jsx)(g.TableCell,{children:a.doctor||a.doctor_name||""}),Array.from({length:Math.max(...i.map(a=>"S"===t&&"scanNames"in a&&a.scanNames?a.scanNames.length:a.total_scan||a.totalScans||0),0)},(a,c)=>(0,b.jsx)(g.TableCell,{children:d[c]||""},c)),(0,b.jsx)(g.TableCell,{className:"text-center",children:a.total_scan||a.totalScans||0}),(0,b.jsxs)(g.TableCell,{className:"font-medium text-green-600",children:["â‚¹",parseFloat(String(a.amount||0)).toFixed(2)]})]},a.cro||c)}):(0,b.jsx)(g.TableRow,{children:(0,b.jsx)(g.TableCell,{className:"text-center",colSpan:13+Math.max(...(i.length>0?i:[{total_scan:0}]).map(a=>"S"===t&&"scanNames"in a&&a.scanNames?a.scanNames.length:a.total_scan||0),0),children:"No revenue data found"})})})]})}),w>1&&(0,b.jsx)(g.Pagination,{currentPage:m,totalPages:w,onPageChange:n,totalItems:i.length,itemsPerPage:o})]})]})})}}];

//# sourceMappingURL=src_app_admin_daily-revenue-report_page_tsx_26a82e3b._.js.map